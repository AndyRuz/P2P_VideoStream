# Kivy Layout File for P2P Video Streaming
# Defines the UI structure and styling

<Button>:
    background_normal: ''
    background_color: 0.8, 0.8, 0.85, 1
    color: 0, 0, 0, 1
    
<PeerConfigScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 15

        # Settings button in top-left
        BoxLayout:
            orientation: 'horizontal'
            size_hint_y: 0.1
            spacing: 10

            Button:
                text: 'Settings'
                size_hint_x: 0.15
                font_size: '24sp'
                background_normal: ''
                background_color: 0.8, 0.8, 0.85, 1
                color: 0, 0, 0, 1
                on_release: root.show_settings()
            Label:
                text: 'P2P Video Streaming'
                font_size: '32sp'
                bold: True
                halign: 'center'
                valign: 'middle'
                text_size: self.size

        # Status
        Label:
            id: status_label
            text: 'Peer not started'
            size_hint_y: 0.08
            color: 1, 0, 0, 1
            halign: 'center'
            valign: 'middle'
            text_size: self.size

        # Profile Selection or New Profile
        BoxLayout:
            orientation: 'vertical'
            spacing: 15
            size_hint_y: 0.7

            # Existing profiles section
            BoxLayout:
                orientation: 'vertical'
                padding: 10
                spacing: 10
                size_hint_y: 0.45
                canvas.before:
                    Color:
                        rgba: 0.9, 0.9, 0.95, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [10]

                Label:
                    text: 'Select Existing Profile or Create New'
                    font_size: '18sp'
                    bold: True
                    halign: 'center'
                    valign: 'middle'
                    text_size: self.size

                ScrollView:
                    size_hint_y: 0.7
                    GridLayout:
                        id: profiles_list
                        cols: 2   # two columns: name + port
                        spacing: 10
                        size_hint_y: None
                        height: self.minimum_height

                        # Example profile entries
                        Label:
                            text: "Suzy"
                            halign: "left"
                            valign: "middle"
                            text_size: self.size

                        Label:
                            text: "Port: 5000"
                            halign: "left"
                            valign: "middle"
                            text_size: self.size

            Button:
                id: start_button
                text: 'Start with New Profile'
                size_hint_y: 0.15
                background_normal: ''
                background_color: 0.75, 0.75, 0.8, 1
                color: 0, 0, 0, 1
                on_release: root.start_peer()

            
        
        # New profile configuration
            BoxLayout:
                orientation: 'vertical'
                padding: 15
                spacing: 15
                size_hint_y: 0.55
                canvas.before:
                    Color:
                        rgba: 0.95, 0.95, 0.97, 1
                    RoundedRectangle:
                        pos: self.pos
                        size: self.size
                        radius: [10]

                GridLayout:
                    cols: 2
                    spacing: 10
                    row_default_height: '40dp'
                    row_force_default: True
                    size_hint_y: None
                    height: self.minimum_height

                    Label:
                        text: "Peer ID:"
                        halign: "left"
                        valign: "middle"
                        text_size: self.size

                    TextInput:
                        id: peer_id_input
                        hint_text: "New Peer ID"
                        multiline: False

                    Label:
                        text: "Port:"
                        halign: "left"
                        valign: "middle"
                        text_size: self.size

                    TextInput:
                        id: port_input
                        hint_text: "Port"
                        text: "5000"
                        multiline: False

                    Label:
                        text: "Tracker Host:"
                        halign: "left"
                        valign: "middle"
                        text_size: self.size

                    TextInput:
                        id: tracker_host_input
                        hint_text: "Tracker Host"
                        text: "localhost"
                        multiline: False

                    Label:
                        text: "Tracker Port:"
                        halign: "left"
                        valign: "middle"
                        text_size: self.size

                    TextInput:
                        id: tracker_port_input
                        hint_text: "Tracker Port"
                        text: "6000"
                        multiline: False
<MyVideosScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 15
        spacing: 15

        BoxLayout:
            size_hint_y: 0.08
            spacing: 10
            Button:
                text: 'Settings'
                size_hint_x: None
                width: dp(120)
                font_size: '22sp'
                on_release: root.show_settings()
            Widget:
            Button:
                text: 'User'
                size_hint_x: None
                width: dp(120)
                font_size: '22sp'
                on_release: root.show_user_menu()

        BoxLayout:
            size_hint_y: 0.1
            spacing: 10
            Label:
                text: 'My Video Library'
                font_size: '22sp'
                bold: True
                halign: 'left'
            Button:
                text: 'Upload Video'
                size_hint_x: None
                width: dp(180)
                on_release: root.upload_video()

        BoxLayout:
            size_hint_y: 0.08
            spacing: 10
            Button:
                text: 'My Videos'
                disabled: True
            Button:
                text: 'Network'
                on_release: app.root.current = 'network'
            Button:
                text: 'Peers'
                on_release: app.root.current = 'peers'

        BoxLayout:
            orientation: 'horizontal'
            spacing: 20

            BoxLayout:
                orientation: 'vertical'
                spacing: 10
                Label:
                    text: 'My Uploaded Videos'
                    size_hint_y: 0.08
                    font_size: '18sp'
                    bold: True
                ScrollView:
                    bar_width: dp(8)
                    GridLayout:
                        id: uploaded_videos_list
                        cols: 1
                        spacing: 10
                        size_hint_y: None
                        height: self.minimum_height

            BoxLayout:
                orientation: 'vertical'
                spacing: 10
                Label:
                    text: 'Network Obtained Videos'
                    size_hint_y: 0.08
                    font_size: '18sp'
                    bold: True
                ScrollView:
                    bar_width: dp(8)
                    GridLayout:
                        id: downloaded_videos_list
                        cols: 1
                        spacing: 10
                        size_hint_y: None
                        height: self.minimum_height


<NetworkBrowseScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 15
        spacing: 15

        BoxLayout:
            size_hint_y: 0.08
            spacing: 10
            Button:
                text: 'Settings'
                size_hint_x: None
                width: dp(120)
                font_size: '22sp'
                on_release: root.show_settings()
            Widget:
            Button:
                text: 'User'
                size_hint_x: None
                width: dp(120)
                font_size: '22sp'
                on_release: root.show_user_menu()

        BoxLayout:
            size_hint_y: 0.1
            spacing: 10
            Label:
                text: 'Network Videos'
                font_size: '22sp'
                bold: True
                halign: 'left'
            Button:
                text: 'Refresh'
                size_hint_x: None
                width: dp(160)
                on_release: root.refresh_network()

        BoxLayout:
            size_hint_y: 0.08
            spacing: 10
            Button:
                text: 'My Videos'
                on_release: app.root.current = 'my_videos'
            Button:
                text: 'Network'
                disabled: True
            Button:
                text: 'Peers'
                on_release: app.root.current = 'peers'

        ScrollView:
            bar_width: dp(8)
            GridLayout:
                id: network_videos_list
                cols: 1
                spacing: 15
                size_hint_y: None
                height: self.minimum_height



<PeersScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: 20
        spacing: 20

        BoxLayout:
            size_hint_y: 0.1
            spacing: 10
            Button:
                text: 'Settings'
                size_hint_x: None
                width: dp(130)
                font_size: '22sp'
                on_release: root.show_settings()
            Widget:
            Button:
                text: 'User'
                size_hint_x: None
                width: dp(130)
                font_size: '22sp'
                on_release: root.show_user_menu()

        BoxLayout:
            size_hint_y: None
            height: dp(60)
            Label:
                text: 'Network Peers'
                font_size: '26sp'
                bold: True
                halign: 'center'

        BoxLayout:
            orientation: 'vertical'
            size_hint_y: None
            height: dp(140)
            padding: 12
            spacing: 8
            canvas.before:
                Color:
                    rgba: 0.8, 0.9, 1, 1
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [10]

            Label:
                id: my_peer_info
                text: 'Peer ID: ---\nHost: ---\nPort: ---'
                halign: 'left'
                valign: 'top'
                font_size: '16sp'
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1] + dp(10)

        BoxLayout:
            size_hint_y: 0.1
            spacing: 10
            Button:
                text: 'My Videos'
                on_release: app.root.current = 'my_videos'
            Button:
                text: 'Network'
                on_release: app.root.current = 'network'
            Button:
                text: 'Peers'
                disabled: True

        BoxLayout:
            orientation: 'horizontal'
            spacing: 25

            BoxLayout:
                orientation: 'vertical'
                spacing: 10
                Label:
                    text: 'Connected Users'
                    font_size: '20sp'
                    bold: True
                    size_hint_y: None
                    height: dp(32)

                ScrollView:
                    bar_width: dp(8)
                    GridLayout:
                        id: connected_users_list
                        cols: 1
                        spacing: 15
                        padding: 10
                        size_hint_y: None
                        height: self.minimum_height

                Button:
                    text: 'Refresh Users'
                    size_hint_y: None
                    height: dp(40)
                    on_release: root.refresh_connected_users()

            BoxLayout:
                orientation: 'vertical'
                spacing: 10
                Label:
                    text: 'Friends'
                    font_size: '20sp'
                    bold: True
                    size_hint_y: None
                    height: dp(32)

                ScrollView:
                    bar_width: dp(8)
                    GridLayout:
                        id: friends_list
                        cols: 1
                        spacing: 15
                        padding: 10
                        size_hint_y: None
                        height: self.minimum_height

        BoxLayout:
            id: manual_connection_box
            orientation: 'horizontal'
            size_hint_y: None
            height: 0
            padding: 12
            spacing: 10
            canvas.before:
                Color:
                    rgba: 0.6, 1, 0.6, 0.3
                RoundedRectangle:
                    pos: self.pos
                    size: self.size
                    radius: [10]

            Label:
                id: manual_connection_label
                text: ''
                font_size: '16sp'
                halign: 'left'
                valign: 'middle'
                text_size: self.size

            Button:
                id: disconnect_btn
                text: 'Disconnect'
                size_hint_x: None
                width: dp(150)
                font_size: '20sp'
                on_release: root.disconnect_manual()
